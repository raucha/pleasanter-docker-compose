name: build and test

on: 
  push:
#   schedule:
#     - cron: '* 10 * * *'

jobs:
  job_build:
    name: build_docker_image
    runs-on: ubuntu-latest
    steps: 
      - uses: actions/checkout@v2
      - run: ls ${{ github.workspace }}
#       - run: docker-compose build -f ./docker-compose.yml
      - run: docker-compose build
#       - run: docker save pleasanter > /tmp/docker-image.tar
#       - uses: actions/upload-artifact@v2
#         with:
#           name: docker-image
#           path: /tmp/docker-image.tar
  job_connection_test:
    name: connection_test
    runs-on: ubuntu-latest
    steps:
#       - name: Download Docker Image (Artifact)
#         uses: actions/download-artifact@v2
#         with:
#           name: docker-image
#           path: /tmp/docker-image.tar
      - name: Run connection test
        run: |
          docker-compose build
          docker-compose up
          sleep 60
          ./test/test

# jobs:
#   job_1:
#     name: Add 3 and 7
#     runs-on: ubuntu-latest
#     steps:
#       - shell: bash
#         run: |
#           expr 3 + 7 > math-homework.txt
#       - name: Upload math result for job 1
#         uses: actions/upload-artifact@v2
#         with:
#           name: homework
#           path: math-homework.txt

#   job_2:
#     name: Multiply by 9
#     needs: job_1
#     runs-on: windows-latest
#     steps:
#       - name: Download math result for job 1
#         uses: actions/download-artifact@v2
#         with:
#           name: homework
#       - shell: bash
#         run: |
#           value=`cat math-homework.txt`
#           expr $value \* 9 > math-homework.txt
#       - name: Upload math result for job 2
#         uses: actions/upload-artifact@v2
#         with:
#           name: homework
#           path: math-homework.txt

#   job_3:
#     name: Display results
#     needs: job_2
#     runs-on: macOS-latest
#     steps:
#       - name: Download math result for job 2
#         uses: actions/download-artifact@v2
#         with:
#           name: homework
#       - name: Print the final result
#         shell: bash
#         run: |
#           value=`cat math-homework.txt`
#           echo The result is $value
